# -- coding: utf-8 --
# @Time: 2022-03-27 15:50
# @Author: WangCx
# @File: model
# @Project: HypergraphNN
import torch
import torch.nn as nn
from torch.nn.init import xavier_normal_, xavier_uniform_
from tqdm import tqdm
import random
import torch.nn.functional as F
import math


class BaseClass(torch.nn.Module):
    def __init__(self):
        super(BaseClass, self).__init__()
        self.cur_itr = torch.nn.Parameter(torch.tensor(0, dtype=torch.int32), requires_grad=False)
        self.best_mrr = torch.nn.Parameter(torch.tensor(0, dtype=torch.float64), requires_grad=False)
        self.best_itr = torch.nn.Parameter(torch.tensor(0, dtype=torch.int32), requires_grad=False)


class HyperNet(BaseClass):
    def __init__(self, dataset, emb_dim, hidden_drop):
        super(HyperNet, self).__init__()
        self.emb_dim = emb_dim
        self.dataset = dataset
        self.E = torch.nn.Embedding(dataset.num_ent, emb_dim, padding_idx=0)
        self.R = torch.nn.Embedding(dataset.num_rel, emb_dim, padding_idx=0)
        self.W0 = torch.nn.Parameter(torch.empty(size=(2*emb_dim+300, 300)))
        self.W1 = torch.nn.Parameter(torch.empty(size=(2*emb_dim, 300)))
        self.W2 = torch.nn.Parameter(torch.empty(size=(emb_dim, 300)))
        self.a = torch.nn.Parameter(torch.empty(size=(300, 1)))
        xavier_normal_(self.E.weight.data)
        xavier_normal_(self.R.weight.data)
        xavier_normal_(self.W0.data)
        xavier_normal_(self.a.data)
        xavier_normal_(self.W1.data)
        xavier_normal_(self.W2.data)
        self.hidden_drop_rate = hidden_drop
        self.hidden_drop = torch.nn.Dropout(self.hidden_drop_rate)
        self.leakyrelu = torch.nn.LeakyReLU(0.2)


        self.in_channels = 1
        self.out_channels = self.dataset.arity_lst[-1]
        self.filt_h = 1
        self.filt_w = 1
        self.stride = 2

        self.max_arity = self.dataset.arity_lst[-1]


        self.bn0 = torch.nn.BatchNorm2d(self.in_channels)
        self.inp_drop = torch.nn.Dropout(0.2)

        fc_length = (1-self.filt_h+1)*math.floor((emb_dim-self.filt_w)/self.stride + 1)*self.out_channels

        self.bn2 = torch.nn.BatchNorm1d(fc_length)
        # Projection network
        self.fc = torch.nn.Linear(fc_length, emb_dim)
        self.device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')

        # size of the convolution filters outputted by the hypernetwork
        fc1_length = self.in_channels*self.out_channels*self.filt_h*self.filt_w
        # Hypernetwork
        self.fc1 = torch.nn.Linear(emb_dim + self.max_arity + 1, fc1_length) # (306, 5)
        self.fc2 = torch.nn.Linear(self.max_arity + 1, fc1_length) # (6, 5)


    def er_pos_emb(self, r_emb, e_emb):
        return torch.mm(torch.cat((r_emb, e_emb), dim=1), self.W1)


    def convolve(self, r, ei, pos):

        e = ei.view(-1, 1, 1, self.E.weight.size(1))
        x = e
        x = self.inp_drop(x)
        one_hot_target = (pos == torch.arange(self.max_arity + 1).reshape(self.max_arity + 1)).float().to(self.device)
        poses = one_hot_target.repeat(r.shape[0]).view(-1, self.max_arity + 1)
        one_hot_target.requires_grad = False
        poses.requires_grad = False
        k = self.fc2(poses)
        k = k.view(-1, self.in_channels, self.out_channels, self.filt_h, self.filt_w)
        k = k.view(e.size(0)*self.in_channels*self.out_channels, 1, self.filt_h, self.filt_w)
        x = x.permute(1, 0, 2, 3)
        x = F.conv2d(x, k, stride=self.stride, groups=e.size(0))
        x = x.view(e.size(0), 1, self.out_channels, 1-self.filt_h+1, -1)
        x = x.permute(0, 3, 4, 1, 2)
        x = torch.sum(x, dim=3)
        x = x.permute(0, 3, 1, 2).contiguous()
        x = x.view(e.size(0), -1)
        x = self.fc(x)
        return x

    def forward(self, batch, ms, bs):
        r_idx = batch[:, 0]
        r = self.R(r_idx)

        if batch.shape[1] == 3:
            # e1 = self.convolve(r, self.E(batch[:, 1]), 0)*ms[:, 0].view(-1, 1) + bs[:, 0].view(-1, 1)
            # e2 = self.convolve(r, self.E(batch[:, 2]), 1)*ms[:, 1].view(-1, 1) + bs[:, 1].view(-1, 1)
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * ms[:,0].view(-1, 1) + bs[:,0].view(-1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * ms[:,1].view(-1, 1) + bs[:,1].view(-1, 1)


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re1_att = torch.exp(torch.cosine_similarity(r, e1, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)))
            re2_att = torch.exp(torch.cosine_similarity(r, e2, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)))

            r = re1*re1_att.view(-1, 1) + re2*re2_att.view(-1, 1)

            e12 = torch.mm(torch.cat((e1, e2, r), dim=1), self.W0)
            e21 = torch.mm(torch.cat((e2, e1, r), dim=1), self.W0)

            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(e12, self.a))) / torch.exp(self.leakyrelu(torch.mm(e12, self.a)))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(e21, self.a))) / torch.exp(self.leakyrelu(torch.mm(e21, self.a)))
            # e1 = self.linear(torch.cat((e1, torch.tanh(e2*e1_e2_att)), dim=1))
            # e2 = self.linear(torch.cat((e2, torch.tanh(e1*e2_e1_att)), dim=1))

            new_e1 = torch.mm(e1, self.W2) + torch.tanh(e12*e1_e2_att)
            new_e2 = torch.mm(e2, self.W2) + torch.tanh(e21*e2_e1_att)




            e = new_e1 * new_e2 * r

        elif batch.shape[1] == 4:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * ms[:,0].view(-1, 1) + bs[:,0].view(-1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * ms[:,1].view(-1, 1) + bs[:,1].view(-1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * ms[:,2].view(-1, 1) + bs[:,2].view(-1, 1)


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re1_att = torch.exp(torch.cosine_similarity(r, e1, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)))
            re2_att = torch.exp(torch.cosine_similarity(r, e2, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)))
            re3_att = torch.exp(torch.cosine_similarity(r, e3, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)))

            r = re1*re1_att.view(-1, 1) + re2*re2_att.view(-1, 1) + re3*re3_att.view(-1, 1)

            e12 = torch.mm(torch.cat((e1, e2, r), dim=1), self.W0)
            e13 = torch.mm(torch.cat((e1, e3, r), dim=1), self.W0)
            e21 = torch.mm(torch.cat((e2, e1, r), dim=1), self.W0)
            e23 = torch.mm(torch.cat((e2, e3, r), dim=1), self.W0)
            e31 = torch.mm(torch.cat((e3, e1, r), dim=1), self.W0)
            e32 = torch.mm(torch.cat((e3, e2, r), dim=1), self.W0)

            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(e12, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(e13, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(e21, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(e23, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(e31, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(e32, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))))



            new_e1 = torch.mm(e1, self.W2) + torch.tanh(e12*e1_e2_att + e13*e1_e3_att)
            new_e2 = torch.mm(e2, self.W2) + torch.tanh(e21*e2_e1_att + e23*e2_e3_att)
            new_e3 = torch.mm(e3, self.W2) + torch.tanh(e31*e3_e1_att + e32*e3_e2_att)
            # e1 = torch.mm(torch.cat((e1, (e2*e1_e2_att + e3*e1_e3_att)), dim=1), self.W0)
            # e2 = torch.mm(torch.cat((e2, (e1*e2_e1_att + e3*e2_e3_att)), dim=1), self.W0)
            # e3 = torch.mm(torch.cat((e3, (e1*e3_e1_att + e2*e3_e2_att)), dim=1), self.W0)

            e = new_e1 * new_e2 * new_e3 * r

        elif batch.shape[1] == 5:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * ms[:,0].view(-1, 1) + bs[:,0].view(-1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * ms[:,1].view(-1, 1) + bs[:,1].view(-1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * ms[:,2].view(-1, 1) + bs[:,2].view(-1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * ms[:,3].view(-1, 1) + bs[:,3].view(-1, 1)

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re1_att = torch.exp(torch.cosine_similarity(r, e1, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)))
            re2_att = torch.exp(torch.cosine_similarity(r, e2, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)))
            re3_att = torch.exp(torch.cosine_similarity(r, e3, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)))
            re4_att = torch.exp(torch.cosine_similarity(r, e4, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)))

            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            r = (re1 * re1_att.view(-1, 1) + re2 * re2_att.view(-1, 1) + re3 * re3_att.view(-1, 1) + re4 * re4_att.view(-1, 1))

            e12 = torch.mm(torch.cat((e1, e2, r), dim=1), self.W0)
            e13 = torch.mm(torch.cat((e1, e3, r), dim=1), self.W0)
            e14 = torch.mm(torch.cat((e1, e4, r), dim=1), self.W0)
            e21 = torch.mm(torch.cat((e2, e1, r), dim=1), self.W0)
            e23 = torch.mm(torch.cat((e2, e3, r), dim=1), self.W0)
            e24 = torch.mm(torch.cat((e2, e4, r), dim=1), self.W0)
            e31 = torch.mm(torch.cat((e3, e1, r), dim=1), self.W0)
            e32 = torch.mm(torch.cat((e3, e2, r), dim=1), self.W0)
            e34 = torch.mm(torch.cat((e3, e4, r), dim=1), self.W0)
            e41 = torch.mm(torch.cat((e4, e1, r), dim=1), self.W0)
            e42 = torch.mm(torch.cat((e4, e2, r), dim=1), self.W0)
            e43 = torch.mm(torch.cat((e4, e3, r), dim=1), self.W0)



            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(e12, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(e13, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(e14, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(e21, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(e23, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(e24, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(e31, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(e32, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(e34, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(e41, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(e42, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(e43, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att)), dim=1), self.W0)
            new_e1 = torch.mm(e1, self.W2) + torch.tanh(e12 * e1_e2_att + e13 * e1_e3_att + e14 * e1_e4_att)
            new_e2 = torch.mm(e2, self.W2) + torch.tanh(e21 * e2_e1_att + e23 * e2_e3_att + e24 * e2_e4_att)
            new_e3 = torch.mm(e3, self.W2) + torch.tanh(e31 * e3_e1_att + e32 * e3_e2_att + e34 * e3_e4_att)
            new_e4 = torch.mm(e4, self.W2) + torch.tanh(e41 * e4_e1_att + e42 * e4_e2_att + e43 * e4_e3_att)




            e = new_e1 * new_e2 * new_e3 * new_e4 * r


        elif batch.shape[1] == 6:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * ms[:,0].view(-1, 1) + bs[:,0].view(-1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * ms[:,1].view(-1, 1) + bs[:,1].view(-1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * ms[:,2].view(-1, 1) + bs[:,2].view(-1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * ms[:,3].view(-1, 1) + bs[:,3].view(-1, 1)
            e5 = self.convolve(r, self.E(batch[:, 5]), 4) * ms[:,4].view(-1, 1) + bs[:,4].view(-1, 1)

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att
            re1_att = torch.exp(torch.cosine_similarity(r, e1, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)))
            re2_att = torch.exp(torch.cosine_similarity(r, e2, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)))
            re3_att = torch.exp(torch.cosine_similarity(r, e3, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)))
            re4_att = torch.exp(torch.cosine_similarity(r, e4, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)))
            re5_att = torch.exp(torch.cosine_similarity(r, e5, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)))

            r = (re1 * re1_att.view(-1, 1) + re2 * re2_att.view(-1, 1) + re3 * re3_att.view(-1, 1) + re4 * re4_att.view(-1, 1) + re5 * re5_att.view(-1, 1))



            e12 = torch.mm(torch.cat((e1, e2, r), dim=1), self.W0)
            e13 = torch.mm(torch.cat((e1, e3, r), dim=1), self.W0)
            e14 = torch.mm(torch.cat((e1, e4, r), dim=1), self.W0)
            e15 = torch.mm(torch.cat((e1, e5, r), dim=1), self.W0)
            e21 = torch.mm(torch.cat((e2, e1, r), dim=1), self.W0)
            e23 = torch.mm(torch.cat((e2, e3, r), dim=1), self.W0)
            e24 = torch.mm(torch.cat((e2, e4, r), dim=1), self.W0)
            e25 = torch.mm(torch.cat((e2, e5, r), dim=1), self.W0)
            e31 = torch.mm(torch.cat((e3, e1, r), dim=1), self.W0)
            e32 = torch.mm(torch.cat((e3, e2, r), dim=1), self.W0)
            e34 = torch.mm(torch.cat((e3, e4, r), dim=1), self.W0)
            e35 = torch.mm(torch.cat((e3, e5, r), dim=1), self.W0)
            e41 = torch.mm(torch.cat((e4, e1, r), dim=1), self.W0)
            e42 = torch.mm(torch.cat((e4, e2, r), dim=1), self.W0)
            e43 = torch.mm(torch.cat((e4, e3, r), dim=1), self.W0)
            e45 = torch.mm(torch.cat((e4, e5, r), dim=1), self.W0)
            e51 = torch.mm(torch.cat((e5, e1, r), dim=1), self.W0)
            e52 = torch.mm(torch.cat((e5, e2, r), dim=1), self.W0)
            e53 = torch.mm(torch.cat((e5, e3, r), dim=1), self.W0)
            e54 = torch.mm(torch.cat((e5, e4, r), dim=1), self.W0)



            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(e12, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(e13, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(e14, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(e15, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(e21, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(e23, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(e24, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(e25, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(e31, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(e32, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(e34, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(e35, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(e41, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(e42, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(e43, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(e45, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(e51, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(e52, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(e53, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(e54, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))))



            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att + z5*e1_e5_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att + z5*e2_e5_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att + z5*e3_e5_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att + z5*e4_e5_att)), dim=1), self.W0)
            # new_e5 = torch.mm(torch.cat((e5, (z1*e5_e1_att + z2*e5_e2_att + z3*e5_e3_att + z4*e5_e4_att)), dim=1), self.W0)
            new_e1 = torch.mm(e1, self.W2) + torch.tanh(e12*e1_e2_att + e13*e1_e3_att + e14*e1_e4_att + e15*e1_e5_att)
            new_e2 = torch.mm(e2, self.W2) + torch.tanh(e21*e2_e1_att + e23*e2_e3_att + e24*e2_e4_att + e25*e2_e5_att)
            new_e3 = torch.mm(e3, self.W2) + torch.tanh(e31*e3_e1_att + e32*e3_e2_att + e34*e3_e4_att + e35*e3_e5_att)
            new_e4 = torch.mm(e4, self.W2) + torch.tanh(e41*e4_e1_att + e42*e4_e2_att + e43*e4_e3_att + e45*e4_e5_att)
            new_e5 = torch.mm(e5, self.W2) + torch.tanh(e51*e5_e1_att + e52*e5_e2_att + e53*e5_e3_att + e54*e5_e4_att)

            e = new_e1 * new_e2 * new_e3 * new_e4 * new_e5 * r

        elif batch.shape[1] == 7:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * ms[:,0].view(-1, 1) + bs[:,0].view(-1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * ms[:,1].view(-1, 1) + bs[:,1].view(-1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * ms[:,2].view(-1, 1) + bs[:,2].view(-1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * ms[:,3].view(-1, 1) + bs[:,3].view(-1, 1)
            e5 = self.convolve(r, self.E(batch[:, 5]), 4) * ms[:,4].view(-1, 1) + bs[:,4].view(-1, 1)
            e6 = self.convolve(r, self.E(batch[:, 6]), 5) * ms[:,5].view(-1, 1) + bs[:,5].view(-1, 1)

            e12 = torch.mm(torch.cat((e1, e2, r), dim=1), self.W0)
            e13 = torch.mm(torch.cat((e1, e3, r), dim=1), self.W0)
            e14 = torch.mm(torch.cat((e1, e4, r), dim=1), self.W0)
            e15 = torch.mm(torch.cat((e1, e5, r), dim=1), self.W0)
            e16 = torch.mm(torch.cat((e1, e6, r), dim=1), self.W0)
            e21 = torch.mm(torch.cat((e2, e1, r), dim=1), self.W0)
            e23 = torch.mm(torch.cat((e2, e3, r), dim=1), self.W0)
            e24 = torch.mm(torch.cat((e2, e4, r), dim=1), self.W0)
            e25 = torch.mm(torch.cat((e2, e5, r), dim=1), self.W0)
            e26 = torch.mm(torch.cat((e2, e6, r), dim=1), self.W0)
            e31 = torch.mm(torch.cat((e3, e1, r), dim=1), self.W0)
            e32 = torch.mm(torch.cat((e3, e2, r), dim=1), self.W0)
            e34 = torch.mm(torch.cat((e3, e4, r), dim=1), self.W0)
            e35 = torch.mm(torch.cat((e3, e5, r), dim=1), self.W0)
            e36 = torch.mm(torch.cat((e3, e6, r), dim=1), self.W0)
            e41 = torch.mm(torch.cat((e4, e1, r), dim=1), self.W0)
            e42 = torch.mm(torch.cat((e4, e2, r), dim=1), self.W0)
            e43 = torch.mm(torch.cat((e4, e3, r), dim=1), self.W0)
            e45 = torch.mm(torch.cat((e4, e5, r), dim=1), self.W0)
            e46 = torch.mm(torch.cat((e4, e6, r), dim=1), self.W0)
            e51 = torch.mm(torch.cat((e5, e1, r), dim=1), self.W0)
            e52 = torch.mm(torch.cat((e5, e2, r), dim=1), self.W0)
            e53 = torch.mm(torch.cat((e5, e3, r), dim=1), self.W0)
            e54 = torch.mm(torch.cat((e5, e4, r), dim=1), self.W0)
            e56 = torch.mm(torch.cat((e5, e6, r), dim=1), self.W0)
            e61 = torch.mm(torch.cat((e6, e1, r), dim=1), self.W0)
            e62 = torch.mm(torch.cat((e6, e2, r), dim=1), self.W0)
            e63 = torch.mm(torch.cat((e6, e3, r), dim=1), self.W0)
            e64 = torch.mm(torch.cat((e6, e4, r), dim=1), self.W0)
            e65 = torch.mm(torch.cat((e6, e5, r), dim=1), self.W0)

            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(e12, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))) + torch.exp(self.leakyrelu(torch.mm(e16, self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(e13, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))) + torch.exp(self.leakyrelu(torch.mm(e16, self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(e14, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))) + torch.exp(self.leakyrelu(torch.mm(e16, self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(e15, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))) + torch.exp(self.leakyrelu(torch.mm(e16, self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(e16, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e12, self.a))) + torch.exp(self.leakyrelu(torch.mm(e13, self.a))) + torch.exp(self.leakyrelu(torch.mm(e14, self.a))) + torch.exp(self.leakyrelu(torch.mm(e15, self.a))) + torch.exp(self.leakyrelu(torch.mm(e16, self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(e21, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))) + torch.exp(self.leakyrelu(torch.mm(e26, self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(e23, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))) + torch.exp(self.leakyrelu(torch.mm(e26, self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(e24, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))) + torch.exp(self.leakyrelu(torch.mm(e26, self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(e25, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))) + torch.exp(self.leakyrelu(torch.mm(e26, self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(e26, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e21, self.a))) + torch.exp(self.leakyrelu(torch.mm(e23, self.a))) + torch.exp(self.leakyrelu(torch.mm(e24, self.a))) + torch.exp(self.leakyrelu(torch.mm(e25, self.a))) + torch.exp(self.leakyrelu(torch.mm(e26, self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(e31, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))) + torch.exp(self.leakyrelu(torch.mm(e36, self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(e32, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))) + torch.exp(self.leakyrelu(torch.mm(e36, self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(e34, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))) + torch.exp(self.leakyrelu(torch.mm(e36, self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(e35, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))) + torch.exp(self.leakyrelu(torch.mm(e36, self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(e36, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e31, self.a))) + torch.exp(self.leakyrelu(torch.mm(e32, self.a))) + torch.exp(self.leakyrelu(torch.mm(e34, self.a))) + torch.exp(self.leakyrelu(torch.mm(e35, self.a))) + torch.exp(self.leakyrelu(torch.mm(e36, self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(e41, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))) + torch.exp(self.leakyrelu(torch.mm(e46, self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(e42, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))) + torch.exp(self.leakyrelu(torch.mm(e46, self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(e43, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))) + torch.exp(self.leakyrelu(torch.mm(e46, self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(e45, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))) + torch.exp(self.leakyrelu(torch.mm(e46, self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(e46, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e41, self.a))) + torch.exp(self.leakyrelu(torch.mm(e42, self.a))) + torch.exp(self.leakyrelu(torch.mm(e43, self.a))) + torch.exp(self.leakyrelu(torch.mm(e45, self.a))) + torch.exp(self.leakyrelu(torch.mm(e46, self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(e51, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))) + torch.exp(self.leakyrelu(torch.mm(e56, self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(e52, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))) + torch.exp(self.leakyrelu(torch.mm(e56, self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(e53, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))) + torch.exp(self.leakyrelu(torch.mm(e56, self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(e54, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))) + torch.exp(self.leakyrelu(torch.mm(e56, self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(e56, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e51, self.a))) + torch.exp(self.leakyrelu(torch.mm(e52, self.a))) + torch.exp(self.leakyrelu(torch.mm(e53, self.a))) + torch.exp(self.leakyrelu(torch.mm(e54, self.a))) + torch.exp(self.leakyrelu(torch.mm(e56, self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(e61, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e61, self.a))) + torch.exp(self.leakyrelu(torch.mm(e62, self.a))) + torch.exp(self.leakyrelu(torch.mm(e63, self.a))) + torch.exp(self.leakyrelu(torch.mm(e64, self.a))) + torch.exp(self.leakyrelu(torch.mm(e65, self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(e62, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e61, self.a))) + torch.exp(self.leakyrelu(torch.mm(e62, self.a))) + torch.exp(self.leakyrelu(torch.mm(e63, self.a))) + torch.exp(self.leakyrelu(torch.mm(e64, self.a))) + torch.exp(self.leakyrelu(torch.mm(e65, self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(e63, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e61, self.a))) + torch.exp(self.leakyrelu(torch.mm(e62, self.a))) + torch.exp(self.leakyrelu(torch.mm(e63, self.a))) + torch.exp(self.leakyrelu(torch.mm(e64, self.a))) + torch.exp(self.leakyrelu(torch.mm(e65, self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(e64, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e61, self.a))) + torch.exp(self.leakyrelu(torch.mm(e62, self.a))) + torch.exp(self.leakyrelu(torch.mm(e63, self.a))) + torch.exp(self.leakyrelu(torch.mm(e64, self.a))) + torch.exp(self.leakyrelu(torch.mm(e65, self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(e65, self.a))) / (torch.exp(self.leakyrelu(torch.mm(e61, self.a))) + torch.exp(self.leakyrelu(torch.mm(e62, self.a))) + torch.exp(self.leakyrelu(torch.mm(e63, self.a))) + torch.exp(self.leakyrelu(torch.mm(e64, self.a))) + torch.exp(self.leakyrelu(torch.mm(e65, self.a))))


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att
            re1_att = torch.exp(torch.cosine_similarity(r, e1, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))
            re2_att = torch.exp(torch.cosine_similarity(r, e2, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))
            re3_att = torch.exp(torch.cosine_similarity(r, e3, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))
            re4_att = torch.exp(torch.cosine_similarity(r, e4, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))
            re5_att = torch.exp(torch.cosine_similarity(r, e5, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))
            re6_att = torch.exp(torch.cosine_similarity(r, e6, dim=1)) / (torch.exp(torch.cosine_similarity(r, e1, dim=1)) + torch.exp(torch.cosine_similarity(r, e2, dim=1)) + torch.exp(torch.cosine_similarity(r, e3, dim=1)) + torch.exp(torch.cosine_similarity(r, e4, dim=1)) + torch.exp(torch.cosine_similarity(r, e5, dim=1)) + torch.exp(torch.cosine_similarity(r, e6, dim=1)))

            r = (re1 * re1_att.view(-1, 1) + re2 * re2_att.view(-1, 1) + re3 * re3_att.view(-1, 1) + re4 * re4_att.view(-1, 1) + re5 * re5_att.view(-1, 1) + re6 * re6_att.view(-1, 1))


            new_e1 = torch.mm(e1, self.W2) + torch.tanh(e12*e1_e2_att + e13*e1_e3_att + e14*e1_e4_att + e15*e1_e5_att + e16*e1_e6_att)
            new_e2 = torch.mm(e2, self.W2) + torch.tanh(e21*e2_e1_att + e23*e2_e3_att + e24*e2_e4_att + e25*e2_e5_att + e26*e2_e6_att)
            new_e3 = torch.mm(e3, self.W2) + torch.tanh(e31*e3_e1_att + e32*e3_e2_att + e34*e3_e4_att + e35*e3_e5_att + e36*e3_e6_att)
            new_e4 = torch.mm(e4, self.W2) + torch.tanh(e41*e4_e1_att + e42*e4_e2_att + e43*e4_e3_att + e45*e4_e5_att + e46*e4_e6_att)
            new_e5 = torch.mm(e5, self.W2) + torch.tanh(e51*e5_e1_att + e52*e5_e2_att + e53*e5_e3_att + e54*e5_e4_att + e56*e5_e6_att)
            new_e6 = torch.mm(e6, self.W2) + torch.tanh(e61*e6_e1_att + e62*e6_e2_att + e63*e6_e3_att + e64*e6_e4_att + e65*e6_e5_att)

            e = new_e1 * new_e2 * new_e3 * new_e4 * new_e5 * new_e6 * r


        elif batch.shape[1] == 8:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re2_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re3_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re4_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re5_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re6_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att)), dim=1), self.W0)
            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7



        elif batch.shape[1] == 9:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re6_att = torch.exp(self.leakyrelu(re6)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            re8_att = torch.exp(self.leakyrelu(re8)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e1_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e2_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e3_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e4_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e5_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e6_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e7_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))))
            e8_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))
            e8_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att)), dim=1), self.W0)
            e8 = torch.mm(torch.cat((e8, torch.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8


        elif batch.shape[1] == 10:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            e9 = self.E(batch[:, 9])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            # re9 = torch.matmul(self.er_pos_emb(r, e9), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re9 = self.er_pos_emb(r, e9)
            re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re6_att = torch.exp(self.leakyrelu(re6)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re7_att = torch.exp(self.leakyrelu(re7)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re8_att = torch.exp(self.leakyrelu(re8)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            re9_att = torch.exp(self.leakyrelu(re9)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)) + torch.exp(self.leakyrelu(re6)) + torch.exp(self.leakyrelu(re7)) + torch.exp(self.leakyrelu(re8)) + torch.exp(self.leakyrelu(re9)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att + re9 * re9_att
            e1_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e1_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e1, e9), dim=1), self.a))))
            e2_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e2_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e2, e9), dim=1), self.a))))
            e3_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e3_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e3, e9), dim=1), self.a))))
            e4_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e4_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e4, e9), dim=1), self.a))))
            e5_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e5_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e5, e9), dim=1), self.a))))
            e6_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e6_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e6, e9), dim=1), self.a))))
            e7_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e7_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e8), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e7, e9), dim=1), self.a))))
            e8_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e8_e9_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e8, e9), dim=1), self.a))))
            e9_e1_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e2_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e3_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e4_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e5_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e6_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e7_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))
            e9_e8_att = torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))) / (torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e1), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e2), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e3), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e4), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e5), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e6), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e7), dim=1), self.a))) + torch.exp(self.leakyrelu(torch.mm(torch.cat((e9, e8), dim=1), self.a))))

            e1 = torch.mm(torch.cat((e1, torch.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att + e9*e1_e9_att)), dim=1), self.W0)
            e2 = torch.mm(torch.cat((e2, torch.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att + e9*e2_e9_att)), dim=1), self.W0)
            e3 = torch.mm(torch.cat((e3, torch.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att + e9*e3_e9_att)), dim=1), self.W0)
            e4 = torch.mm(torch.cat((e4, torch.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att + e9*e4_e9_att)), dim=1), self.W0)
            e5 = torch.mm(torch.cat((e5, torch.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att + e9*e5_e9_att)), dim=1), self.W0)
            e6 = torch.mm(torch.cat((e6, torch.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att + e9*e6_e9_att)), dim=1), self.W0)
            e7 = torch.mm(torch.cat((e7, torch.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att + e9*e7_e9_att)), dim=1), self.W0)
            e8 = torch.mm(torch.cat((e8, torch.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att + e9*e8_e9_att)), dim=1), self.W0)
            e9 = torch.mm(torch.cat((e9, torch.tanh(e1*e9_e1_att + e2*e9_e2_att + e3*e9_e3_att + e4*e9_e4_att + e5*e9_e5_att + e6*e9_e6_att + e7*e9_e7_att + e8*e9_e8_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8 * e9


        x = e
        x = self.hidden_drop(x)
        return torch.sum(x, dim=1)


